<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Neela & Papa - Tamagotchi</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: url('fond-stitch.jpg') no-repeat center center fixed;
      background-size: cover;
      touch-action: manipulation;
    }

    .gif-stitch {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      top: calc(100vh - 200px);
      width: 150px;
      opacity: 0;
      transition: opacity 0.5s;
    }

    .visible {
      opacity: 1;
    }

    .btn {
      position: absolute;
      bottom: 40px;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: none;
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
      z-index: 5;
    }

    #btn-manger { left: 20%; background-image: url('bouton-manger.png'); }
    #btn-jouer  { left: 40%; background-image: url('bouton-jouer.png'); }
    #btn-dodo   { left: 60%; background-image: url('bouton-dodo.png'); }
    #btn-bain   { left: 80%; background-image: url('bouton-bain.png'); }

    .jauge {
      position: absolute;
      bottom: 120px;
      width: 40px;
      height: 100px;
      background: #eee;
      border: 2px solid #333;
      border-radius: 8px;
      overflow: hidden;
    }

    .barre {
      width: 100%;
      height: 0%;
      background: linear-gradient(to top, #00f0ff, #0ff);
      transition: height 0.3s;
    }

    #jauge-manger { left: 20%; transform: translateX(-50%); }
    #jauge-jouer  { left: 40%; transform: translateX(-50%); }
    #jauge-dodo   { left: 60%; transform: translateX(-50%); }
    #jauge-bain   { left: 80%; transform: translateX(-50%); }

    #zone-cliquable {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 150px;
      cursor: pointer;
      z-index: 10;
    }

    #transition-gif {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 200px;
      transform: translate(-50%, -50%);
      display: none;
      z-index: 99;
    }
  </style>
</head>
<body>
  <div id="zone-cliquable"></div>

  <img id="gif-stitch" class="gif-stitch" src="stitch5.gif" />

  <button id="btn-manger" class="btn"></button>
  <button id="btn-jouer" class="btn"></button>
  <button id="btn-dodo" class="btn"></button>
  <button id="btn-bain" class="btn"></button>

  <div id="jauge-manger" class="jauge"><div class="barre"></div></div>
  <div id="jauge-jouer" class="jauge"><div class="barre"></div></div>
  <div id="jauge-dodo" class="jauge"><div class="barre"></div></div>
  <div id="jauge-bain" class="jauge"><div class="barre"></div></div>

  <img id="transition-gif" src="" />

  <script>
    const gif = document.getElementById('gif-stitch');
    const gifs = {
      manger: ['stitch16.gif'],
      jouer: ['stitch7.gif', 'stitch9.gif', 'stitch13.gif', 'stitch14.gif', 'stitch15.gif'],
      dodo: [
        ['stitch2.gif', 'stitch3.gif', 'stitch20.gif'],
        ['stitch2.gif', 'stitch3.gif', 'stitch21.gif'],
        ['stitch2.gif', 'stitch3.gif', 'stitch22.gif']
      ],
      bain: ['stitch18.gif', 'stitch19.gif']
    };

    const jauges = {
      manger: 0,
      jouer: 0,
      dodo: 0,
      bain: 0
    };

    function updateJauge(nom) {
      jauges[nom] = Math.min(jauges[nom] + 100, 2000);
      const barre = document.querySelector(`#jauge-${nom} .barre`);
      barre.style.height = Math.min((jauges[nom] / 20), 100) + '%';
    }

    function showGif(srcList, delay = 1000) {
      gif.classList.remove('visible');
      setTimeout(async () => {
        if (Array.isArray(srcList)) {
          for (const src of srcList) {
            gif.src = src;
            gif.classList.add('visible');
            await new Promise(r => setTimeout(r, delay));
            gif.classList.remove('visible');
            await new Promise(r => setTimeout(r, 200));
          }
        } else {
          gif.src = srcList;
          gif.classList.add('visible');
        }
      }, 300);
    }

    document.getElementById('btn-manger').onclick = () => {
      updateJauge('manger');
      const gifList = gifs.manger[Math.floor(Math.random() * gifs.manger.length)];
      showGif(gifList);
    };

    document.getElementById('btn-jouer').onclick = () => {
      updateJauge('jouer');
      const gifList = gifs.jouer[Math.floor(Math.random() * gifs.jouer.length)];
      showGif(gifList);
    };

    document.getElementById('btn-dodo').onclick = () => {
      updateJauge('dodo');
      const sequence = gifs.dodo[Math.floor(Math.random() * gifs.dodo.length)];
      showGif(sequence, 1000);
    };

    document.getElementById('btn-bain').onclick = () => {
      updateJauge('bain');
      showGif(gifs.bain, 1000);
    };

    // Retour page 1 avec animation stitch24.gif
    const transition = document.getElementById('transition-gif');
    document.getElementById('zone-cliquable').addEventListener('click', () => {
      transition.src = 'stitch24.gif';
      transition.style.display = 'block';
      setTimeout(() => {
        window.location.href = 'index.html';
      }, 3500);
    });

    // DÃ©sactivation zoom mobile
    document.querySelectorAll('button').forEach(btn => {
      btn.addEventListener('touchstart', e => e.preventDefault());
    });
  </script>
</body>
</html>
