<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Tamagotchi Stitch</title>
  <style>
    body {
      margin: 0;
      background: url('fond-stitch.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: Arial, sans-serif;
      text-align: center;
      color: white;
    }

    #header {
      height: 100px;
      position: relative;
    }

    #back-btn {
      position: absolute;
      top: 10px;
      left: 10px;
      width: 100px;
      height: 100px;
      border-radius: 50%;
      cursor: pointer;
    }

    h1 {
      font-size: 0; /* invisible mais cliquable */
    }

    #stitch {
      width: 200px;
      height: auto;
      margin-top: 1cm;
      border-radius: 20px;
    }

    .buttons {
      margin: 20px 0;
    }

    .buttons button {
      background-color: rgba(255, 255, 255, 0.3);
      color: white;
      font-size: 20px;
      padding: 10px 20px;
      margin: 10px;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      backdrop-filter: blur(5px);
      transition: transform 0.2s, background-color 0.2s;
    }

    .buttons button:hover {
      background-color: rgba(255, 255, 255, 0.6);
      transform: scale(1.05);
    }

    .gauge-container {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .gauge {
      width: 80px;
      height: 150px;
      background: linear-gradient(to top, #00eaff, #00c1e0);
      border-radius: 20px;
      position: relative;
      overflow: hidden;
      border: 3px solid white;
    }

    .gauge-fill {
      position: absolute;
      bottom: 0;
      width: 100%;
      background-color: #fff;
      transition: height 0.3s;
    }

    .gauge-label {
      margin-top: 10px;
      font-size: 14px;
    }
  </style>
</head>
<body>

  <div id="header">
    <div id="back-btn" onclick="window.location.href='index.html'"></div>
    <h1>Tamagotchi</h1>
  </div>

  <img id="stitch" src="stitch5.jpg" alt="Stitch" />

  <div class="buttons">
    <button onclick="playGif(['stitch16.gif'], 'manger')">üçç Manger</button>
    <button onclick="playGif(['stitch7.gif','stitch9.gif','stitch13.gif','stitch14.gif','stitch15.gif'], 'jouer')">üèÑ Jouer</button>
    <button onclick="playGif(['stitch18.gif','stitch19.gif'], 'bain')">üöø Bain</button>
    <button onclick="playGif(['stitch2.gif','stitch3.gif','stitch20.gif','stitch21.gif','stitch22.gif'], 'dodo')">üò¥ Dodo</button>
  </div>

  <div class="gauge-container">
    <div class="gauge" id="energieGauge">
      <div class="gauge-fill" id="energieFill"></div>
    </div>
    <div class="gauge" id="funGauge">
      <div class="gauge-fill" id="funFill"></div>
    </div>
    <div class="gauge" id="propreteGauge">
      <div class="gauge-fill" id="propreteFill"></div>
    </div>
  </div>
  <div class="gauge-container">
    <div class="gauge-label">√ânergie</div>
    <div class="gauge-label">Fun</div>
    <div class="gauge-label">Propret√©</div>
  </div>

  <!-- Audio -->
  <audio id="actionSound" src="blop.mp3" preload="auto"></audio>

  <script>
    const stitch = document.getElementById("stitch");
    const defaultStitch = "stitch5.jpg";
    const sound = document.getElementById("actionSound");

    let gauges = {
      energie: 100,
      fun: 100,
      proprete: 100
    };

    function loadGauges() {
      const saved = localStorage.getItem("stitchGauges");
      if (saved) {
        gauges = JSON.parse(saved);
      }
    }

    function saveGauges() {
      localStorage.setItem("stitchGauges", JSON.stringify(gauges));
    }

    function updateGauges() {
      document.getElementById("energieFill").style.height = gauges.energie + "%";
      document.getElementById("funFill").style.height = gauges.fun + "%";
      document.getElementById("propreteFill").style.height = gauges.proprete + "%";
      saveGauges();
    }

    function playGif(gifList, actionType) {
      sound.play(); // son
      let gif;

      if (actionType === 'dodo') {
        gif = [gifList[0], gifList[1], gifList[2 + Math.floor(Math.random() * 3)]];
        gauges.energie = Math.min(100, gauges.energie + 15);
      } else if (actionType === 'jouer') {
        gif = [gifList[Math.floor(Math.random() * gifList.length)]];
        gauges.fun = Math.min(100, gauges.fun + 10);
        gauges.energie = Math.max(0, gauges.energie - 5);
      } else if (actionType === 'bain') {
        gif = gifList;
        gauges.proprete = 100;
      } else if (actionType === 'manger') {
        gif = gifList;
        gauges.energie = Math.min(100, gauges.energie + 20);
      }

      let delay = 0;
      function nextFrame(index) {
        if (index >= gif.length) {
          stitch.src = defaultStitch;
          updateGauges();
          return;
        }
        stitch.src = gif[index];
        setTimeout(() => nextFrame(index + 1), 1000);
      }

      nextFrame(0);
    }

    // Animation froid al√©atoire
    setInterval(() => {
      if (Math.random() < 0.05) {
        let coldGif = Math.random() < 0.5 ? "stitch10.gif" : "stitch11.gif";
        stitch.src = coldGif;
        setTimeout(() => {
          stitch.src = defaultStitch;
        }, 2000);
      }
    }, 7000);

    loadGauges();
    updateGauges();
  </script>
</body>
</html>
