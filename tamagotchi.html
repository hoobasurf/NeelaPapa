<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Neela & Papa - Tamagotchi</title>
  <style>
    body {
      margin: 0;
      background: url('fond-stitch.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: Arial, sans-serif;
      overflow: hidden;
      touch-action: manipulation;
    }

    #zone-cliquable {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 80px;
      cursor: pointer;
      z-index: 1000;
    }

    .gif-stitch {
      position: absolute;
      width: 150px;
      height: auto;
      left: 50%;
      transform: translate(-50%, -100%);
      opacity: 0;
      transition: opacity 0.5s;
      z-index: 999;
    }

    .visible {
      opacity: 1;
    }

    .bouton {
      position: absolute;
      width: 70px;
      height: 70px;
      border-radius: 50%;
      border: none;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      cursor: pointer;
      background: radial-gradient(circle, #fdfdfd, #ccc);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 26px;
      transition: transform 0.1s;
    }

    .bouton:active {
      transform: scale(0.95);
    }

    .jauge {
      position: absolute;
      width: 10px;
      height: 100px;
      border-radius: 10px;
      background: rgba(255,255,255,0.3);
      overflow: hidden;
    }

    .remplissage {
      width: 100%;
      height: 0%;
      transition: height 0.3s;
    }

    .manger .remplissage { background: orange; }
    .jouer .remplissage { background: deepskyblue; }
    .dormir .remplissage { background: plum; }

    #btn-manger { bottom: 30px; left: 20%; }
    #btn-jouer  { bottom: 30px; left: 45%; }
    #btn-dodo   { bottom: 30px; left: 70%; }
    #btn-bain   { top: 100px; right: 30px; }

    #jauge-manger { bottom: 110px; left: 22%; }
    #jauge-jouer  { bottom: 110px; left: 47%; }
    #jauge-dodo   { bottom: 110px; left: 72%; }
  </style>
</head>
<body>

<div id="zone-cliquable"></div>

<img id="gif-stitch" class="gif-stitch" src="" />

<button id="btn-manger" class="bouton">üçó</button>
<button id="btn-jouer" class="bouton">üéÆ</button>
<button id="btn-dodo" class="bouton">üåô</button>
<button id="btn-bain" class="bouton">üõÅ</button>

<div id="jauge-manger" class="jauge manger"><div class="remplissage"></div></div>
<div id="jauge-jouer" class="jauge jouer"><div class="remplissage"></div></div>
<div id="jauge-dodo" class="jauge dormir"><div class="remplissage"></div></div>

<script>
  const gif = document.getElementById('gif-stitch');
  const gifs = {
    manger: ['stitch16.gif'],
    jouer: ['stitch7.gif', 'stitch9.gif', 'stitch13.gif', 'stitch14.gif', 'stitch15.gif'],
    dodo: [
      ['stitch2.gif', 'stitch3.gif', 'stitch20.gif'],
      ['stitch2.gif', 'stitch3.gif', 'stitch21.gif'],
      ['stitch2.gif', 'stitch3.gif', 'stitch22.gif']
    ],
    bain: ['stitch18.gif', 'stitch19.gif'],
    froid: ['stitch10.gif', 'stitch11.gif'],
    normal: 'stitch5.gif',
    triste: 'stitch1.gif',
    enerve: 'stitch17.gif',
    sommeil: 'stitch12.gif'
  };

  let jauges = {
    manger: 0,
    jouer: 0,
    dormir: 0
  };

  const max = 2000;

  function updateJauge(type) {
    if (jauges[type] < max) jauges[type] += 100;
    const pourcent = Math.min(100, (jauges[type] / max) * 100);
    document.querySelector(`#jauge-${type} .remplissage`).style.height = pourcent + '%';
  }

  function jouerGif(src) {
    gif.src = src;
    gif.classList.add('visible');
    setTimeout(() => {
      gif.classList.remove('visible');
    }, 2000);
  }

  function jouerGifSequence(sequence) {
    let index = 0;
    function nextGif() {
      if (index >= sequence.length) return;
      gif.src = sequence[index];
      gif.classList.add('visible');
      setTimeout(() => {
        gif.classList.remove('visible');
        index++;
        setTimeout(nextGif, 300);
      }, 2000);
    }
    nextGif();
  }

  // Boutons
  document.getElementById('btn-manger').addEventListener('click', () => {
    const gifFile = gifs.manger[0];
    jouerGif(gifFile);
    updateJauge('manger');
  });

  document.getElementById('btn-jouer').addEventListener('click', () => {
    const gifFile = gifs.jouer[Math.floor(Math.random() * gifs.jouer.length)];
    jouerGif(gifFile);
    updateJauge('jouer');
  });

  document.getElementById('btn-dodo').addEventListener('click', () => {
    const sequence = gifs.dodo[Math.floor(Math.random() * gifs.dodo.length)];
    jouerGifSequence(sequence);
    updateJauge('dormir');
  });

  document.getElementById('btn-bain').addEventListener('click', () => {
    jouerGifSequence(gifs.bain);
  });

  // Zone retour (stitch25.gif puis redirect)
  document.getElementById('zone-cliquable').addEventListener('click', () => {
    gif.src = 'stitch25.gif';
    gif.classList.add('visible');
    setTimeout(() => {
      window.location.href = 'index.html'; // Modifier ici si autre page
    }, 3500);
  });

  // Anti zoom mobile double tap
  let lastTouch = 0;
  document.addEventListener('touchend', function (e) {
    const now = new Date().getTime();
    if (now - lastTouch <= 300) {
      e.preventDefault();
    }
    lastTouch = now;
  }, { passive: false });
</script>

</body>
</html>
