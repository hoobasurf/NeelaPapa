<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Tamagotchi Stitch</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: url('fond-stitch.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: 'Comic Sans MS', cursive;
      overflow-x: hidden;
    }

    #container {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 100px;
    }

    #stitch-image {
      width: 250px;
      height: 250px;
      margin-bottom: 30px;
      transition: opacity 0.3s ease-in-out;
    }

    .button-group {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-bottom: 25px;
    }

    button {
      background-color: rgba(255, 255, 255, 0.6);
      border: none;
      border-radius: 50%;
      padding: 15px;
      font-size: 25px;
      cursor: pointer;
    }

    .gauges {
      display: flex;
      justify-content: center;
      gap: 50px;
      margin-top: 30px;
    }

    .gauge {
      width: 40px;
      height: 300px;
      background-image: url('coquillage.png');
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      position: relative;
    }

    .gauge-fill {
      position: absolute;
      bottom: 10%;
      width: 100%;
      background-color: rgba(255, 255, 255, 0.8);
      border-radius: 10px;
    }

    .night {
      filter: brightness(0.5);
    }
  </style>
</head>
<body>

  <div id="container">
    <img id="stitch-image" src="stitch5.gif" alt="Stitch">

    <div class="button-group">
      <button onclick="triggerAction('manger')">üçç</button>
      <button onclick="triggerAction('jouer')">üèÑ</button>
      <button onclick="triggerAction('dormir')">üò¥</button>
      <button onclick="triggerAction('bain')">üöø</button>
    </div>

    <div class="gauges">
      <div class="gauge"><div id="gauge-manger" class="gauge-fill"></div></div>
      <div class="gauge"><div id="gauge-jouer" class="gauge-fill"></div></div>
      <div class="gauge"><div id="gauge-dormir" class="gauge-fill"></div></div>
      <div class="gauge"><div id="gauge-bain" class="gauge-fill"></div></div>
    </div>
  </div>

  <script>
    const stitch = document.getElementById("stitch-image");

    const gauges = {
      manger: { element: document.getElementById("gauge-manger"), value: 100 },
      jouer: { element: document.getElementById("gauge-jouer"), value: 100 },
      dormir: { element: document.getElementById("gauge-dormir"), value: 100 },
      bain:   { element: document.getElementById("gauge-bain"), value: 100 }
    };

    const gifSets = {
      manger: ["stitch16.gif"],
      jouer: ["stitch7.gif", "stitch9.gif", "stitch13.gif", "stitch14.gif", "stitch15.gif"],
      dormir: ["stitch2.gif", "stitch3.gif", "stitch20.gif", "stitch21.gif", "stitch22.gif"],
      bain: ["stitch18.gif", "stitch19.gif"]
    };

    const moods = {
      triste: "stitch1.gif",
      fatigu√©: "stitch12.gif",
      √©nerv√©: "stitch17.gif",
      froid: ["stitch10.gif", "stitch11.gif"]
    };

    function updateGauges() {
      for (let key in gauges) {
        const value = gauges[key].value;
        gauges[key].element.style.height = value * 3 + "px";
        localStorage.setItem(`gauge-${key}`, value);
      }
      updateMood();
    }

    function updateMood() {
      const anyLow = Object.values(gauges).some(g => g.value < 20);
      if (gauges.dormir.value < 20) stitch.src = moods.fatigu√©;
      else if (gauges.manger.value < 20) stitch.src = moods.triste;
      else if (gauges.jouer.value < 20) stitch.src = moods.√©nerv√©;
      else if (gauges.bain.value < 20) stitch.src = moods.froid[Math.floor(Math.random()*2)];
      else stitch.src = "stitch5.gif";
    }

    function triggerAction(action) {
      const gifList = gifSets[action];
      const selectedGif = gifList[Math.floor(Math.random() * gifList.length)];
      stitch.src = selectedGif;

      // Augmente la jauge
      gauges[action].value = Math.min(100, gauges[action].value + 20);
      updateGauges();

      setTimeout(() => {
        updateMood();
      }, 6000); // gif = 6 secondes
    }

    function autoDecrease() {
      for (let key in gauges) {
        gauges[key].value = Math.max(0, gauges[key].value - 1);
      }
      updateGauges();
    }

    // Sauvegarde
    window.onload = () => {
      for (let key in gauges) {
        const saved = parseInt(localStorage.getItem(`gauge-${key}`));
        if (!isNaN(saved)) gauges[key].value = saved;
      }
      updateGauges();
      applyDayNight();
    };

    setInterval(autoDecrease, 20000); // toutes les 20 sec

    function applyDayNight() {
      const hour = new Date().getHours();
      if (hour < 7 || hour > 20) {
        document.body.classList.add("night");
      } else {
        document.body.classList.remove("night");
      }
    }
  </script>
</body>
</html>
