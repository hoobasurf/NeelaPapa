<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tamagotchi Stitch</title>
<style>
  body {
    margin: 0;
    background: url('fond.jpg') no-repeat center center/cover;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    font-family: Arial, sans-serif;
    overflow: hidden;
  }

  #gif-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 300px;
  }

  #gif-container img {
    max-height: 100%;
    max-width: 100%;
  }

  .gauges {
    display: flex;
    gap: 15px;
    margin-top: 10px;
  }

  .gauge {
    width: 80px;
    height: 15px;
    background: rgba(255,255,255,0.4);
    border-radius: 10px;
    overflow: hidden;
    border: 1px solid #000;
  }

  .gauge-fill {
    height: 100%;
    background: linear-gradient(to right, #00bfff, #1e90ff);
    width: 0%;
    transition: width 0.3s;
  }

  .buttons {
    display: flex;
    gap: 15px;
    margin-top: 15px;
  }

  .buttons button {
    padding: 10px 15px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
  }

  #return-zone {
    position: absolute;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    width: 120px;
    height: 120px;
    border-radius: 50%;
    z-index: 1000;
    cursor: pointer;
  }

  #return-gif {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: transparent;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1100;
    visibility: hidden;
    pointer-events: none;
  }

  #return-gif img {
    max-width: 80%;
    height: auto;
  }
</style>
</head>
<body>

<div id="gif-container">
  <img id="stitch-gif" src="stitch1.gif" alt="Stitch">
</div>

<div class="gauges">
  <div class="gauge"><div id="gauge-manger" class="gauge-fill"></div></div>
  <div class="gauge"><div id="gauge-jouer" class="gauge-fill"></div></div>
  <div class="gauge"><div id="gauge-dodo" class="gauge-fill"></div></div>
  <div class="gauge"><div id="gauge-bain" class="gauge-fill"></div></div>
</div>

<div class="buttons">
  <button onclick="playAction('manger')">üçó Manger</button>
  <button onclick="playAction('jouer')">üéÆ Jouer</button>
  <button onclick="playAction('dodo')">üåô Dodo</button>
  <button onclick="playAction('bain')">üõÅ Bain</button>
</div>

<!-- Zone retour -->
<div id="return-zone"></div>
<div id="return-gif">
  <img src="stitch24.gif" alt="Retour">
</div>

<script>
  const gif = document.getElementById('stitch-gif');
  const gauges = {
    manger: document.getElementById('gauge-manger'),
    jouer: document.getElementById('gauge-jouer'),
    dodo: document.getElementById('gauge-dodo'),
    bain: document.getElementById('gauge-bain')
  };

  const gifs = {
    manger: ["stitch16.gif"],
    jouer: ["stitch7.gif", "stitch9.gif", "stitch13.gif", "stitch14.gif", "stitch15.gif"],
    dodo: [
      ["stitch2.gif", "stitch3.gif", "stitch20.gif"],
      ["stitch2.gif", "stitch3.gif", "stitch21.gif"],
      ["stitch2.gif", "stitch3.gif", "stitch22.gif"]
    ],
    bain: ["stitch18.gif", "stitch19.gif"]
  };

  let defaultGif = "stitch1.gif";
  let gaugeValues = {manger: 0, jouer: 0, dodo: 0, bain: 0};

  function playAction(type) {
    gaugeValues[type] = Math.min(gaugeValues[type] + 20, 100);
    gauges[type].style.width = gaugeValues[type] + "%";

    if (type === "dodo") {
      let sequence = gifs.dodo[Math.floor(Math.random() * gifs.dodo.length)];
      playGifSequence(sequence);
    } else if (Array.isArray(gifs[type])) {
      let gifToPlay = gifs[type][Math.floor(Math.random() * gifs[type].length)];
      playGifOnce(gifToPlay);
    }
  }

  function playGifOnce(src) {
    gif.src = src + "?t=" + Date.now();
    gif.onload = () => {
      setTimeout(() => {
        gif.src = defaultGif;
      }, 2500); 
    };
  }

  function playGifSequence(sequence) {
    let index = 0;
    function nextGif() {
      if (index < sequence.length) {
        gif.src = sequence[index] + "?t=" + Date.now();
        index++;
        setTimeout(nextGif, 2500);
      } else {
        gif.src = defaultGif;
      }
    }
    nextGif();
  }

  // Retour page 1
  const returnZone = document.getElementById('return-zone');
  const returnGif = document.getElementById('return-gif');
  returnZone.addEventListener('click', () => {
    returnGif.style.visibility = 'visible';
    setTimeout(() => {
      window.location.href = "index.html";
    }, 3500);
  });
</script>
</body>
</html>
