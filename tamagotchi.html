<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Tamagotchi Stitch</title>
  <style>
    body {
      margin: 0;
      background: url('fond-stitch.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: 'Comic Sans MS', cursive;
      overflow-x: hidden;
    }

    .container {
      text-align: center;
      margin-top: 6cm; /* Stitch plus bas */
    }

    #stitch {
      width: 300px;
      height: auto;
      transition: all 0.3s ease-in-out;
    }

    .buttons {
      margin-top: 30px;
    }

    .buttons button {
      font-size: 20px;
      margin: 10px;
      padding: 10px 20px;
      border-radius: 20px;
      border: none;
      background: #00c2cb;
      color: white;
      cursor: pointer;
      box-shadow: 2px 2px 10px rgba(0,0,0,0.3);
      transition: transform 0.2s;
    }

    .buttons button:hover {
      transform: scale(1.1);
    }

    .gauges {
      margin-top: 40px;
      display: flex;
      justify-content: center;
      gap: 40px;
    }

    .gauge-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 150px;
    }

    .gauge-container img {
      width: 80px;
      height: auto;
      margin-bottom: 10px;
    }

    .gauge-bar {
      width: 100%;
      height: 150px; /* 500% plus haut qu'avant (~30px * 5) */
      background-color: rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      overflow: hidden;
      position: relative;
    }

    .gauge-fill {
      position: absolute;
      bottom: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(to top, #00c2cb, #fff);
      transition: height 0.5s;
    }

  </style>
</head>
<body>
  <div class="container">
    <img id="stitch" src="stitch5.gif" alt="Stitch" />

    <div class="buttons">
      <button onclick="feed()">üçç</button>
      <button onclick="play()">üèÑ</button>
      <button onclick="bath()">üöø</button>
      <button onclick="sleep()">üò¥</button>
    </div>

    <div class="gauges">
      <div class="gauge-container">
        <img src="coquillage.png" alt="√ânergie">
        <div class="gauge-bar">
          <div id="energyFill" class="gauge-fill"></div>
        </div>
      </div>
      <div class="gauge-container">
        <img src="coquillage.png" alt="Fun">
        <div class="gauge-bar">
          <div id="funFill" class="gauge-fill"></div>
        </div>
      </div>
      <div class="gauge-container">
        <img src="coquillage.png" alt="Humeur">
        <div class="gauge-bar">
          <div id="humeurFill" class="gauge-fill"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const stitch = document.getElementById("stitch");
    const defaultStitch = "stitch5.gif";
    let gaugeLevels = { energy: 100, fun: 100, mood: 100 };

    function updateGaugeUI() {
      document.getElementById("energyFill").style.height = gaugeLevels.energy + "%";
      document.getElementById("funFill").style.height = gaugeLevels.fun + "%";
      document.getElementById("humeurFill").style.height = gaugeLevels.mood + "%";
    }

    function averageGauge() {
      return (gaugeLevels.energy + gaugeLevels.fun + gaugeLevels.mood) / 3;
    }

    function moodCheck() {
      if      (gaugeLevels.energy  < 30) stitch.src = 'stitch12.gif';  // fatigu√©
      else if (gaugeLevels.fun     < 30) stitch.src = 'stitch17.gif';  // √©nerv√©
      else if (averageGauge()      < 30) stitch.src = 'stitch1.gif';   // triste
      else                               stitch.src = defaultStitch;   // normal
    }

    function decay() {
      for (const key in gaugeLevels) {
        gaugeLevels[key] = Math.max(0, gaugeLevels[key] - 2);
      }
      updateGaugeUI();
      saveGauges();
      moodCheck();
    }

    function saveGauges() {
      localStorage.setItem('gauges', JSON.stringify(gaugeLevels));
    }

    function loadGauges() {
      const saved = localStorage.getItem('gauges');
      if (saved) {
        gaugeLevels = JSON.parse(saved);
        updateGaugeUI();
      }
    }

    function playOnce(gif) {
      stitch.src = gif;
      setTimeout(() => {
        moodCheck();
      }, 4000);
    }

    function playSequence(gifs) {
      let i = 0;
      const next = () => {
        if (i < gifs.length) {
          stitch.src = gifs[i++];
          setTimeout(next, 1300);
        } else {
          moodCheck();
        }
      };
      next();
    }

    function feed() {
      playOnce("stitch16.gif");
      gaugeLevels.mood = Math.min(100, gaugeLevels.mood + 15);
      updateGaugeUI();
      saveGauges();
    }

    function play() {
      const gifs = ["stitch7.gif", "stitch9.gif", "stitch13.gif", "stitch14.gif", "stitch15.gif"];
      const chosen = gifs[Math.floor(Math.random() * gifs.length)];
      playOnce(chosen);
      gaugeLevels.fun = Math.min(100, gaugeLevels.fun + 15);
      updateGaugeUI();
      saveGauges();
    }

    function bath() {
      playSequence(["stitch18.gif", "stitch19.gif"]);
      gaugeLevels.mood = Math.min(100, gaugeLevels.mood + 10);
      updateGaugeUI();
      saveGauges();
    }

    function sleep() {
      const sequences = [
        ["stitch2.gif", "stitch3.gif", "stitch20.gif"],
        ["stitch2.gif", "stitch3.gif", "stitch21.gif"],
        ["stitch2.gif", "stitch3.gif", "stitch22.gif"]
      ];
      const chosen = sequences[Math.floor(Math.random() * sequences.length)];
      playSequence(chosen);
      gaugeLevels.energy = Math.min(100, gaugeLevels.energy + 30);
      updateGaugeUI();
      saveGauges();
    }

    // ‚Üì‚Üì Lancement
    loadGauges();
    updateGaugeUI();
    setInterval(decay, 10000); // baisse toutes les 10 secondes

  </script>
</body>
</html>
